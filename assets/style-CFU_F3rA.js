import{R as b,r as h}from"./index-Xr0Wixvw.js";import{u as Zo}from"./with-selector-DkU5GEue.js";import{I as Ye,H as Uo,s as mn,p as Wo,j as Xo}from"./zoom-Dpg1ms-1.js";function ie(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=ie(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const Go={},Zt=e=>{let t;const n=new Set,o=(a,d)=>{const g=typeof a=="function"?a(t):a;if(!Object.is(g,t)){const f=t;t=d??(typeof g!="object"||g===null)?g:Object.assign({},t,g),n.forEach(E=>E(t,f))}},s=()=>t,l={setState:o,getState:s,getInitialState:()=>u,subscribe:a=>(n.add(a),()=>n.delete(a)),destroy:()=>{(Go?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(o,s,l);return l},Ko=e=>e?Zt(e):Zt,{useDebugValue:qo}=b,{useSyncExternalStoreWithSelector:jo}=Zo,Qo=e=>e;function yn(e,t=Qo,n){const o=jo(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return qo(o),o}const Ut=(e,t)=>{const n=Ko(e),o=(s,i=t)=>yn(n,s,i);return Object.assign(o,n),o},Jo=(e,t)=>e?Ut(e,t):Ut;function se(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}const dt=h.createContext(null),es=dt.Provider,ye={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},xn=ye.error001();function q(e,t){const n=h.useContext(dt);if(n===null)throw new Error(xn);return yn(n,e,t)}const ne=()=>{const e=h.useContext(dt);if(e===null)throw new Error(xn);return h.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},ts=e=>e.userSelectionActive?"none":"all";function ns({position:e,children:t,className:n,style:o,...s}){const i=q(ts),r=`${e}`.split("-");return b.createElement("div",{className:ie(["react-flow__panel",n,...r]),style:{...o,pointerEvents:i},...s},t)}function os({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:b.createElement(ns,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},b.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const ss=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:r=[2,4],labelBgBorderRadius:c=2,children:l,className:u,...a})=>{const d=h.useRef(null),[g,f]=h.useState({x:0,y:0,width:0,height:0}),E=ie(["react-flow__edge-textwrapper",u]);return h.useEffect(()=>{if(d.current){const p=d.current.getBBox();f({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),typeof n>"u"||!n?null:b.createElement("g",{transform:`translate(${e-g.width/2} ${t-g.height/2})`,className:E,visibility:g.width?"visible":"hidden",...a},s&&b.createElement("rect",{width:g.width+2*r[0],x:-r[0],y:-r[1],height:g.height+2*r[1],className:"react-flow__edge-textbg",style:i,rx:c,ry:c}),b.createElement("text",{className:"react-flow__edge-text",y:g.height/2,dy:"0.3em",ref:d,style:o},n),l)};var rs=h.memo(ss);const It=e=>({width:e.offsetWidth,height:e.offsetHeight}),We=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Dt=(e={x:0,y:0},t)=>({x:We(e.x,t[0][0],t[1][0]),y:We(e.y,t[0][1],t[1][1])}),Wt=(e,t,n)=>e<t?We(Math.abs(e-t),1,50)/50:e>n?-We(Math.abs(e-n),1,50)/50:0,En=(e,t)=>{const n=Wt(e.x,35,t.width-35)*20,o=Wt(e.y,35,t.height-35)*20;return[n,o]},Sn=e=>e.getRootNode?.()||window?.document,is=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Rt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),cs=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Xt=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),wt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},as=e=>le(e.width)&&le(e.height)&&le(e.x)&&le(e.y),le=e=>!isNaN(e)&&isFinite(e),K=Symbol.for("internals"),wn=["Enter"," ","Escape"],ls=(e,t)=>{},ds=e=>"nativeEvent"in e;function bt(e){const n=(ds(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const bn=e=>"clientX"in e,we=(e,t)=>{const n=bn(e),o=n?e.clientX:e.touches?.[0].clientX,s=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:s-(t?.top??0)}},it=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,tt=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:g,interactionWidth:f=20})=>b.createElement(b.Fragment,null,b.createElement("path",{id:e,style:a,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:d,markerStart:g}),f&&b.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),s&&le(n)&&le(o)?b.createElement(rs,{x:n,y:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u}):null);tt.displayName="BaseEdge";function qe(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(i=>i.id===e);s&&n(o,{...s})}}function Nn({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,r=Math.abs(o-t)/2,c=o<t?o+r:o-r;return[i,c,s,r]}function Cn({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:c}){const l=e*.125+s*.375+r*.375+n*.125,u=t*.125+i*.375+c*.375+o*.125,a=Math.abs(l-e),d=Math.abs(u-t);return[l,u,a,d]}var Re;(function(e){e.Strict="strict",e.Loose="loose"})(Re||(Re={}));var De;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(De||(De={}));var Je;(function(e){e.Partial="partial",e.Full="full"})(Je||(Je={}));var Se;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Se||(Se={}));var ct;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(ct||(ct={}));var z;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(z||(z={}));function Gt({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===z.Left||e===z.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function vn({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top}){const[r,c]=Gt({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,u]=Gt({pos:i,x1:o,y1:s,x2:e,y2:t}),[a,d,g,f]=Cn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:r,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${r},${c} ${l},${u} ${o},${s}`,a,d,g,f]}const Tt=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=z.Bottom,targetPosition:i=z.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:E,interactionWidth:p})=>{const[m,y,x]=vn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i});return b.createElement(tt,{path:m,labelX:y,labelY:x,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:E,interactionWidth:p})});Tt.displayName="SimpleBezierEdge";const Kt={[z.Left]:{x:-1,y:0},[z.Right]:{x:1,y:0},[z.Top]:{x:0,y:-1},[z.Bottom]:{x:0,y:1}},us=({source:e,sourcePosition:t=z.Bottom,target:n})=>t===z.Left||t===z.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},qt=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function fs({source:e,sourcePosition:t=z.Bottom,target:n,targetPosition:o=z.Top,center:s,offset:i}){const r=Kt[t],c=Kt[o],l={x:e.x+r.x*i,y:e.y+r.y*i},u={x:n.x+c.x*i,y:n.y+c.y*i},a=us({source:l,sourcePosition:t,target:u}),d=a.x!==0?"x":"y",g=a[d];let f=[],E,p;const m={x:0,y:0},y={x:0,y:0},[x,N,v,T]=Nn({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[d]*c[d]===-1){E=s.x??x,p=s.y??N;const L=[{x:E,y:l.y},{x:E,y:u.y}],P=[{x:l.x,y:p},{x:u.x,y:p}];r[d]===g?f=d==="x"?L:P:f=d==="x"?P:L}else{const L=[{x:l.x,y:u.y}],P=[{x:u.x,y:l.y}];if(d==="x"?f=r.x===g?P:L:f=r.y===g?L:P,t===o){const M=Math.abs(e[d]-n[d]);if(M<=i){const S=Math.min(i-1,i-M);r[d]===g?m[d]=(l[d]>e[d]?-1:1)*S:y[d]=(u[d]>n[d]?-1:1)*S}}if(t!==o){const M=d==="x"?"y":"x",S=r[d]===c[M],A=l[M]>u[M],B=l[M]<u[M];(r[d]===1&&(!S&&A||S&&B)||r[d]!==1&&(!S&&B||S&&A))&&(f=d==="x"?L:P)}const C={x:l.x+m.x,y:l.y+m.y},$={x:u.x+y.x,y:u.y+y.y},D=Math.max(Math.abs(C.x-f[0].x),Math.abs($.x-f[0].x)),R=Math.max(Math.abs(C.y-f[0].y),Math.abs($.y-f[0].y));D>=R?(E=(C.x+$.x)/2,p=f[0].y):(E=f[0].x,p=(C.y+$.y)/2)}return[[e,{x:l.x+m.x,y:l.y+m.y},...f,{x:u.x+y.x,y:u.y+y.y},n],E,p,v,T]}function gs(e,t,n,o){const s=Math.min(qt(e,t)/2,qt(t,n)/2,o),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return`L${i} ${r}`;if(e.y===r){const u=e.x<n.x?-1:1,a=e.y<n.y?1:-1;return`L ${i+s*u},${r}Q ${i},${r} ${i},${r+s*a}`}const c=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${r+s*l}Q ${i},${r} ${i+s*c},${r}`}function Nt({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top,borderRadius:r=5,centerX:c,centerY:l,offset:u=20}){const[a,d,g,f,E]=fs({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:i,center:{x:c,y:l},offset:u});return[a.reduce((m,y,x)=>{let N="";return x>0&&x<a.length-1?N=gs(a[x-1],y,a[x+1],r):N=`${x===0?"M":"L"}${y.x} ${y.y}`,m+=N,m},""),d,g,f,E]}const ut=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,sourcePosition:d=z.Bottom,targetPosition:g=z.Top,markerEnd:f,markerStart:E,pathOptions:p,interactionWidth:m})=>{const[y,x,N]=Nt({sourceX:e,sourceY:t,sourcePosition:d,targetX:n,targetY:o,targetPosition:g,borderRadius:p?.borderRadius,offset:p?.offset});return b.createElement(tt,{path:y,labelX:x,labelY:N,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:f,markerStart:E,interactionWidth:m})});ut.displayName="SmoothStepEdge";const kt=h.memo(e=>b.createElement(ut,{...e,pathOptions:h.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));kt.displayName="StepEdge";function ps({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,i,r,c]=Nn({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,i,r,c]}const Ht=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:g,interactionWidth:f})=>{const[E,p,m]=ps({sourceX:e,sourceY:t,targetX:n,targetY:o});return b.createElement(tt,{path:E,labelX:p,labelY:m,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:u,style:a,markerEnd:d,markerStart:g,interactionWidth:f})});Ht.displayName="StraightEdge";function nt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function jt({pos:e,x1:t,y1:n,x2:o,y2:s,c:i}){switch(e){case z.Left:return[t-nt(t-o,i),n];case z.Right:return[t+nt(o-t,i),n];case z.Top:return[t,n-nt(n-s,i)];case z.Bottom:return[t,n+nt(s-n,i)]}}function Mn({sourceX:e,sourceY:t,sourcePosition:n=z.Bottom,targetX:o,targetY:s,targetPosition:i=z.Top,curvature:r=.25}){const[c,l]=jt({pos:n,x1:e,y1:t,x2:o,y2:s,c:r}),[u,a]=jt({pos:i,x1:o,y1:s,x2:e,y2:t,c:r}),[d,g,f,E]=Cn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:l,targetControlX:u,targetControlY:a});return[`M${e},${t} C${c},${l} ${u},${a} ${o},${s}`,d,g,f,E]}const at=h.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=z.Bottom,targetPosition:i=z.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:E,pathOptions:p,interactionWidth:m})=>{const[y,x,N]=Mn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i,curvature:p?.curvature});return b.createElement(tt,{path:y,labelX:x,labelY:N,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:u,labelBgPadding:a,labelBgBorderRadius:d,style:g,markerEnd:f,markerStart:E,interactionWidth:m})});at.displayName="BezierEdge";const Pt=h.createContext(null),hs=Pt.Provider;Pt.Consumer;const ms=()=>h.useContext(Pt),ys=e=>"id"in e&&"source"in e&&"target"in e,xs=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,Ct=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,Es=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Ss=(e,t)=>{if(!e.source||!e.target)return t;let n;return ys(e)?n={...e}:n={...e,id:xs(e)},Es(n,t)?t:t.concat(n)},vt=({x:e,y:t},[n,o,s],i,[r,c])=>{const l={x:(e-n)/s,y:(t-o)/s};return i?{x:r*Math.round(l.x/r),y:c*Math.round(l.y/c)}:l},An=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),Ze=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},_t=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:i,y:r}=Ze(s,t).positionAbsolute;return is(o,Rt({x:i,y:r,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return cs(n)},$n=(e,t,[n,o,s]=[0,0,1],i=!1,r=!1,c=[0,0])=>{const l={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(a=>{const{width:d,height:g,selectable:f=!0,hidden:E=!1}=a;if(r&&!f||E)return!1;const{positionAbsolute:p}=Ze(a,c),m={x:p.x,y:p.y,width:d||0,height:g||0},y=wt(l,m),x=typeof d>"u"||typeof g>"u"||d===null||g===null,N=i&&y>0,v=(d||0)*(g||0);(x||N||y>=v||a.dragging)&&u.push(a)}),u},In=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},Dn=(e,t,n,o,s,i=.1)=>{const r=t/(e.width*(1+i)),c=n/(e.height*(1+i)),l=Math.min(r,c),u=We(l,o,s),a=e.x+e.width/2,d=e.y+e.height/2,g=t/2-a*u,f=n/2-d*u;return{x:g,y:f,zoom:u}},Ie=(e,t=0)=>e.transition().duration(t);function Qt(e,t,n,o){return(t[n]||[]).reduce((s,i)=>(`${e.id}-${i.id}-${n}`!==o&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+i.x+i.width/2,y:(e.positionAbsolute?.y??0)+i.y+i.height/2}),s),[])}function ws(e,t,n,o,s,i){const{x:r,y:c}=we(e),u=t.elementsFromPoint(r,c).find(E=>E.classList.contains("react-flow__handle"));if(u){const E=u.getAttribute("data-nodeid");if(E){const p=zt(void 0,u),m=u.getAttribute("data-handleid"),y=i({nodeId:E,id:m,type:p});if(y){const x=s.find(N=>N.nodeId===E&&N.type===p&&N.id===m);return{handle:{id:m,type:p,nodeId:E,x:x?.x||n.x,y:x?.y||n.y},validHandleResult:y}}}}let a=[],d=1/0;if(s.forEach(E=>{const p=Math.sqrt((E.x-n.x)**2+(E.y-n.y)**2);if(p<=o){const m=i(E);p<=d&&(p<d?a=[{handle:E,validHandleResult:m}]:p===d&&a.push({handle:E,validHandleResult:m}),d=p)}}),!a.length)return{handle:null,validHandleResult:Rn()};if(a.length===1)return a[0];const g=a.some(({validHandleResult:E})=>E.isValid),f=a.some(({handle:E})=>E.type==="target");return a.find(({handle:E,validHandleResult:p})=>f?E.type==="target":g?p.isValid:!0)||a[0]}const bs={source:null,target:null,sourceHandle:null,targetHandle:null},Rn=()=>({handleDomNode:null,isValid:!1,connection:bs,endHandle:null});function Tn(e,t,n,o,s,i,r){const c=s==="target",l=r.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),u={...Rn(),handleDomNode:l};if(l){const a=zt(void 0,l),d=l.getAttribute("data-nodeid"),g=l.getAttribute("data-handleid"),f=l.classList.contains("connectable"),E=l.classList.contains("connectableend"),p={source:c?d:n,sourceHandle:c?g:o,target:c?n:d,targetHandle:c?o:g};u.connection=p,f&&E&&(t===Re.Strict?c&&a==="source"||!c&&a==="target":d!==n||g!==o)&&(u.endHandle={nodeId:d,handleId:g,type:a},u.isValid=i(p))}return u}function Ns({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,i)=>{if(i[K]){const{handleBounds:r}=i[K];let c=[],l=[];r&&(c=Qt(i,r,"source",`${t}-${n}-${o}`),l=Qt(i,r,"target",`${t}-${n}-${o}`)),s.push(...c,...l)}return s},[])}function zt(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function mt(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function Cs(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function kn({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:i,setState:r,isValidConnection:c,edgeUpdaterType:l,onReconnectEnd:u}){const a=Sn(e.target),{connectionMode:d,domNode:g,autoPanOnConnect:f,connectionRadius:E,onConnectStart:p,panBy:m,getNodes:y,cancelConnection:x}=i();let N=0,v;const{x:T,y:I}=we(e),L=a?.elementFromPoint(T,I),P=zt(l,L),C=g?.getBoundingClientRect();if(!C||!P)return;let $,D=we(e,C),R=!1,M=null,S=!1,A=null;const B=Ns({nodes:y(),nodeId:n,handleId:t,handleType:P}),Y=()=>{if(!f)return;const[_,k]=En(D,C);m({x:_,y:k}),N=requestAnimationFrame(Y)};r({connectionPosition:D,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:P,connectionStartHandle:{nodeId:n,handleId:t,type:P},connectionEndHandle:null}),p?.(e,{nodeId:n,handleId:t,handleType:P});function F(_){const{transform:k}=i();D=we(_,C);const{handle:H,validHandleResult:V}=ws(_,a,vt(D,k,!1,[1,1]),E,B,Z=>Tn(Z,d,n,t,s?"target":"source",c,a));if(v=H,R||(Y(),R=!0),A=V.handleDomNode,M=V.connection,S=V.isValid,r({connectionPosition:v&&S?An({x:v.x,y:v.y},k):D,connectionStatus:Cs(!!v,S),connectionEndHandle:V.endHandle}),!v&&!S&&!A)return mt($);M.source!==M.target&&A&&(mt($),$=A,A.classList.add("connecting","react-flow__handle-connecting"),A.classList.toggle("valid",S),A.classList.toggle("react-flow__handle-valid",S))}function w(_){(v||A)&&M&&S&&o?.(M),i().onConnectEnd?.(_),l&&u?.(_),mt($),x(),cancelAnimationFrame(N),R=!1,S=!1,M=null,A=null,a.removeEventListener("mousemove",F),a.removeEventListener("mouseup",w),a.removeEventListener("touchmove",F),a.removeEventListener("touchend",w)}a.addEventListener("mousemove",F),a.addEventListener("mouseup",w),a.addEventListener("touchmove",F),a.addEventListener("touchend",w)}const Jt=()=>!0,vs=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),Ms=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:r}=o;return{connecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n||i?.nodeId===e&&i?.handleId===t&&i?.type===n,clickConnecting:r?.nodeId===e&&r?.handleId===t&&r?.type===n}},Hn=h.forwardRef(({type:e="source",position:t=z.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:r,onConnect:c,children:l,className:u,onMouseDown:a,onTouchStart:d,...g},f)=>{const E=r||null,p=e==="target",m=ne(),y=ms(),{connectOnClick:x,noPanClassName:N}=q(vs,se),{connecting:v,clickConnecting:T}=q(Ms(y,E,e),se);y||m.getState().onError?.("010",ye.error010());const I=C=>{const{defaultEdgeOptions:$,onConnect:D,hasDefaultEdges:R}=m.getState(),M={...$,...C};if(R){const{edges:S,setEdges:A}=m.getState();A(Ss(M,S))}D?.(M),c?.(M)},L=C=>{if(!y)return;const $=bn(C);s&&($&&C.button===0||!$)&&kn({event:C,handleId:E,nodeId:y,onConnect:I,isTarget:p,getState:m.getState,setState:m.setState,isValidConnection:n||m.getState().isValidConnection||Jt}),$?a?.(C):d?.(C)},P=C=>{const{onClickConnectStart:$,onClickConnectEnd:D,connectionClickStartHandle:R,connectionMode:M,isValidConnection:S}=m.getState();if(!y||!R&&!s)return;if(!R){$?.(C,{nodeId:y,handleId:E,handleType:e}),m.setState({connectionClickStartHandle:{nodeId:y,type:e,handleId:E}});return}const A=Sn(C.target),B=n||S||Jt,{connection:Y,isValid:F}=Tn({nodeId:y,id:E,type:e},M,R.nodeId,R.handleId||null,R.type,B,A);F&&I(Y),D?.(C),m.setState({connectionClickStartHandle:null})};return b.createElement("div",{"data-handleid":E,"data-nodeid":y,"data-handlepos":t,"data-id":`${y}-${E}-${e}`,className:ie(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",N,u,{source:!p,target:p,connectable:o,connectablestart:s,connectableend:i,connecting:T,connectionindicator:o&&(s&&!v||i&&v)}]),onMouseDown:L,onTouchStart:L,onClick:x?P:void 0,ref:f,...g},l)});Hn.displayName="Handle";var lt=h.memo(Hn);const Pn=({data:e,isConnectable:t,targetPosition:n=z.Top,sourcePosition:o=z.Bottom})=>b.createElement(b.Fragment,null,b.createElement(lt,{type:"target",position:n,isConnectable:t}),e?.label,b.createElement(lt,{type:"source",position:o,isConnectable:t}));Pn.displayName="DefaultNode";var Mt=h.memo(Pn);const _n=({data:e,isConnectable:t,sourcePosition:n=z.Bottom})=>b.createElement(b.Fragment,null,e?.label,b.createElement(lt,{type:"source",position:n,isConnectable:t}));_n.displayName="InputNode";var zn=h.memo(_n);const On=({data:e,isConnectable:t,targetPosition:n=z.Top})=>b.createElement(b.Fragment,null,b.createElement(lt,{type:"target",position:n,isConnectable:t}),e?.label);On.displayName="OutputNode";var Bn=h.memo(On);const Ot=()=>null;Ot.displayName="GroupNode";const As=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),ot=e=>e.id;function $s(e,t){return se(e.selectedNodes.map(ot),t.selectedNodes.map(ot))&&se(e.selectedEdges.map(ot),t.selectedEdges.map(ot))}const Ln=h.memo(({onSelectionChange:e})=>{const t=ne(),{selectedNodes:n,selectedEdges:o}=q(As,$s);return h.useEffect(()=>{const s={nodes:n,edges:o};e?.(s),t.getState().onSelectionChange.forEach(i=>i(s))},[n,o,e]),null});Ln.displayName="SelectionListener";const Is=e=>!!e.onSelectionChange;function Ds({onSelectionChange:e}){const t=q(Is);return e||t?b.createElement(Ln,{onSelectionChange:e}):null}const Rs=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Oe(e,t){h.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function U(e,t,n){h.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const Ts=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:i,onConnectEnd:r,onClickConnectStart:c,onClickConnectEnd:l,nodesDraggable:u,nodesConnectable:a,nodesFocusable:d,edgesFocusable:g,edgesUpdatable:f,elevateNodesOnSelect:E,minZoom:p,maxZoom:m,nodeExtent:y,onNodesChange:x,onEdgesChange:N,elementsSelectable:v,connectionMode:T,snapGrid:I,snapToGrid:L,translateExtent:P,connectOnClick:C,defaultEdgeOptions:$,fitView:D,fitViewOptions:R,onNodesDelete:M,onEdgesDelete:S,onNodeDrag:A,onNodeDragStart:B,onNodeDragStop:Y,onSelectionDrag:F,onSelectionDragStart:w,onSelectionDragStop:_,noPanClassName:k,nodeOrigin:H,rfId:V,autoPanOnConnect:Z,autoPanOnNodeDrag:W,onError:j,connectionRadius:ee,isValidConnection:te,nodeDragThreshold:J})=>{const{setNodes:X,setEdges:de,setDefaultNodesAndEdges:ce,setMinZoom:ue,setMaxZoom:ae,setTranslateExtent:Q,setNodeExtent:ge,reset:G}=q(Rs,se),O=ne();return h.useEffect(()=>{const re=o?.map(be=>({...be,...$}));return ce(n,re),()=>{G()}},[]),U("defaultEdgeOptions",$,O.setState),U("connectionMode",T,O.setState),U("onConnect",s,O.setState),U("onConnectStart",i,O.setState),U("onConnectEnd",r,O.setState),U("onClickConnectStart",c,O.setState),U("onClickConnectEnd",l,O.setState),U("nodesDraggable",u,O.setState),U("nodesConnectable",a,O.setState),U("nodesFocusable",d,O.setState),U("edgesFocusable",g,O.setState),U("edgesUpdatable",f,O.setState),U("elementsSelectable",v,O.setState),U("elevateNodesOnSelect",E,O.setState),U("snapToGrid",L,O.setState),U("snapGrid",I,O.setState),U("onNodesChange",x,O.setState),U("onEdgesChange",N,O.setState),U("connectOnClick",C,O.setState),U("fitViewOnInit",D,O.setState),U("fitViewOnInitOptions",R,O.setState),U("onNodesDelete",M,O.setState),U("onEdgesDelete",S,O.setState),U("onNodeDrag",A,O.setState),U("onNodeDragStart",B,O.setState),U("onNodeDragStop",Y,O.setState),U("onSelectionDrag",F,O.setState),U("onSelectionDragStart",w,O.setState),U("onSelectionDragStop",_,O.setState),U("noPanClassName",k,O.setState),U("nodeOrigin",H,O.setState),U("rfId",V,O.setState),U("autoPanOnConnect",Z,O.setState),U("autoPanOnNodeDrag",W,O.setState),U("onError",j,O.setState),U("connectionRadius",ee,O.setState),U("isValidConnection",te,O.setState),U("nodeDragThreshold",J,O.setState),Oe(e,X),Oe(t,de),Oe(p,ue),Oe(m,ae),Oe(P,Q),Oe(y,ge),null},en={display:"none"},ks={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Vn="react-flow__node-desc",Fn="react-flow__edge-desc",Hs="react-flow__aria-live",Ps=e=>e.ariaLiveMessage;function _s({rfId:e}){const t=q(Ps);return b.createElement("div",{id:`${Hs}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:ks},t)}function zs({rfId:e,disableKeyboardA11y:t}){return b.createElement(b.Fragment,null,b.createElement("div",{id:`${Vn}-${e}`,style:en},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),b.createElement("div",{id:`${Fn}-${e}`,style:en},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&b.createElement(_s,{rfId:e}))}var et=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,o]=h.useState(!1),s=h.useRef(!1),i=h.useRef(new Set([])),[r,c]=h.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.split("+")),a=u.reduce((d,g)=>d.concat(...g),[]);return[u,a]}return[[],[]]},[e]);return h.useEffect(()=>{const l=typeof document<"u"?document:null,u=t?.target||l;if(e!==null){const a=f=>{if(s.current=f.ctrlKey||f.metaKey||f.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&bt(f))return!1;const p=nn(f.code,c);i.current.add(f[p]),tn(r,i.current,!1)&&(f.preventDefault(),o(!0))},d=f=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&bt(f))return!1;const p=nn(f.code,c);tn(r,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(f[p]),f.key==="Meta"&&i.current.clear(),s.current=!1},g=()=>{i.current.clear(),o(!1)};return u?.addEventListener("keydown",a),u?.addEventListener("keyup",d),window.addEventListener("blur",g),()=>{u?.removeEventListener("keydown",a),u?.removeEventListener("keyup",d),window.removeEventListener("blur",g)}}},[e,o]),n};function tn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function nn(e,t){return t.includes(e)?"code":"key"}function Yn(e,t,n,o){const s=e.parentNode||e.parentId;if(!s)return n;const i=t.get(s),r=Ze(i,o);return Yn(i,t,{x:(n.x??0)+r.x,y:(n.y??0)+r.y,z:(i[K]?.z??0)>(n.z??0)?i[K]?.z??0:n.z??0},o)}function Zn(e,t,n){e.forEach(o=>{const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n?.[o.id]){const{x:i,y:r,z:c}=Yn(o,e,{...o.position,z:o[K]?.z??0},t);o.positionAbsolute={x:i,y:r},o[K].z=c,n?.[o.id]&&(o[K].isParent=!0)}})}function yt(e,t,n,o){const s=new Map,i={},r=o?1e3:0;return e.forEach(c=>{const l=(le(c.zIndex)?c.zIndex:0)+(c.selected?r:0),u=t.get(c.id),a={...c,positionAbsolute:{x:c.position.x,y:c.position.y}},d=c.parentNode||c.parentId;d&&(i[d]=!0);const g=u?.type&&u?.type!==c.type;Object.defineProperty(a,K,{enumerable:!1,value:{handleBounds:g?void 0:u?.[K]?.handleBounds,z:l}}),s.set(c.id,a)}),Zn(s,n,i),s}function Un(e,t={}){const{getNodes:n,width:o,height:s,minZoom:i,maxZoom:r,d3Zoom:c,d3Selection:l,fitViewOnInitDone:u,fitViewOnInit:a,nodeOrigin:d}=e(),g=t.initial&&!u&&a;if(c&&l&&(g||!t.initial)){const E=n().filter(m=>{const y=t.includeHiddenNodes?m.width&&m.height:!m.hidden;return t.nodes?.length?y&&t.nodes.some(x=>x.id===m.id):y}),p=E.every(m=>m.width&&m.height);if(E.length>0&&p){const m=_t(E,d),{x:y,y:x,zoom:N}=Dn(m,o,s,t.minZoom??i,t.maxZoom??r,t.padding??.1),v=Ye.translate(y,x).scale(N);return typeof t.duration=="number"&&t.duration>0?c.transform(Ie(l,t.duration),v):c.transform(l,v),!0}}return!1}function Os(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[K]:o[K],selected:n.selected})}),new Map(t)}function Bs(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function st({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:i,onNodesChange:r,onEdgesChange:c,hasDefaultNodes:l,hasDefaultEdges:u}=n();e?.length&&(l&&o({nodeInternals:Os(e,s)}),r?.(e)),t?.length&&(u&&o({edges:Bs(t,i)}),c?.(t))}const Be=()=>{},Ls={zoomIn:Be,zoomOut:Be,zoomTo:Be,getZoom:()=>1,setViewport:Be,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Be,fitBounds:Be,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Vs=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Fs=()=>{const e=ne(),{d3Zoom:t,d3Selection:n}=q(Vs,se);return h.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(Ie(n,s?.duration),1.2),zoomOut:s=>t.scaleBy(Ie(n,s?.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(Ie(n,i?.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[r,c,l]=e.getState().transform,u=Ye.translate(s.x??r,s.y??c).scale(s.zoom??l);t.transform(Ie(n,i?.duration),u)},getViewport:()=>{const[s,i,r]=e.getState().transform;return{x:s,y:i,zoom:r}},fitView:s=>Un(e.getState,s),setCenter:(s,i,r)=>{const{width:c,height:l,maxZoom:u}=e.getState(),a=typeof r?.zoom<"u"?r.zoom:u,d=c/2-s*a,g=l/2-i*a,f=Ye.translate(d,g).scale(a);t.transform(Ie(n,r?.duration),f)},fitBounds:(s,i)=>{const{width:r,height:c,minZoom:l,maxZoom:u}=e.getState(),{x:a,y:d,zoom:g}=Dn(s,r,c,l,u,i?.padding??.1),f=Ye.translate(a,d).scale(g);t.transform(Ie(n,i?.duration),f)},project:s=>{const{transform:i,snapToGrid:r,snapGrid:c}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),vt(s,i,r,c)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:r,snapGrid:c,domNode:l}=e.getState();if(!l)return s;const{x:u,y:a}=l.getBoundingClientRect(),d={x:s.x-u,y:s.y-a};return vt(d,i,r,c)},flowToScreenPosition:s=>{const{transform:i,domNode:r}=e.getState();if(!r)return s;const{x:c,y:l}=r.getBoundingClientRect(),u=An(s,i);return{x:u.x+c,y:u.y+l}},viewportInitialized:!0}:Ls,[t,n])};function Wn(){const e=Fs(),t=ne(),n=h.useCallback(()=>t.getState().getNodes().map(p=>({...p})),[]),o=h.useCallback(p=>t.getState().nodeInternals.get(p),[]),s=h.useCallback(()=>{const{edges:p=[]}=t.getState();return p.map(m=>({...m}))},[]),i=h.useCallback(p=>{const{edges:m=[]}=t.getState();return m.find(y=>y.id===p)},[]),r=h.useCallback(p=>{const{getNodes:m,setNodes:y,hasDefaultNodes:x,onNodesChange:N}=t.getState(),v=m(),T=typeof p=="function"?p(v):p;if(x)y(T);else if(N){const I=T.length===0?v.map(L=>({type:"remove",id:L.id})):T.map(L=>({item:L,type:"reset"}));N(I)}},[]),c=h.useCallback(p=>{const{edges:m=[],setEdges:y,hasDefaultEdges:x,onEdgesChange:N}=t.getState(),v=typeof p=="function"?p(m):p;if(x)y(v);else if(N){const T=v.length===0?m.map(I=>({type:"remove",id:I.id})):v.map(I=>({item:I,type:"reset"}));N(T)}},[]),l=h.useCallback(p=>{const m=Array.isArray(p)?p:[p],{getNodes:y,setNodes:x,hasDefaultNodes:N,onNodesChange:v}=t.getState();if(N){const I=[...y(),...m];x(I)}else if(v){const T=m.map(I=>({item:I,type:"add"}));v(T)}},[]),u=h.useCallback(p=>{const m=Array.isArray(p)?p:[p],{edges:y=[],setEdges:x,hasDefaultEdges:N,onEdgesChange:v}=t.getState();if(N)x([...y,...m]);else if(v){const T=m.map(I=>({item:I,type:"add"}));v(T)}},[]),a=h.useCallback(()=>{const{getNodes:p,edges:m=[],transform:y}=t.getState(),[x,N,v]=y;return{nodes:p().map(T=>({...T})),edges:m.map(T=>({...T})),viewport:{x,y:N,zoom:v}}},[]),d=h.useCallback(({nodes:p,edges:m})=>{const{nodeInternals:y,getNodes:x,edges:N,hasDefaultNodes:v,hasDefaultEdges:T,onNodesDelete:I,onEdgesDelete:L,onNodesChange:P,onEdgesChange:C}=t.getState(),$=(p||[]).map(A=>A.id),D=(m||[]).map(A=>A.id),R=x().reduce((A,B)=>{const Y=B.parentNode||B.parentId,F=!$.includes(B.id)&&Y&&A.find(_=>_.id===Y);return(typeof B.deletable!="boolean"||B.deletable)&&($.includes(B.id)||F)&&A.push(B),A},[]),M=N.filter(A=>typeof A.deletable=="boolean"?A.deletable:!0),S=M.filter(A=>D.includes(A.id));if(R||S){const A=In(R,M),B=[...S,...A],Y=B.reduce((F,w)=>(F.includes(w.id)||F.push(w.id),F),[]);if((T||v)&&(T&&t.setState({edges:N.filter(F=>!Y.includes(F.id))}),v&&(R.forEach(F=>{y.delete(F.id)}),t.setState({nodeInternals:new Map(y)}))),Y.length>0&&(L?.(B),C&&C(Y.map(F=>({id:F,type:"remove"})))),R.length>0&&(I?.(R),P)){const F=R.map(w=>({id:w.id,type:"remove"}));P(F)}}},[]),g=h.useCallback(p=>{const m=as(p),y=m?null:t.getState().nodeInternals.get(p.id);return!m&&!y?[null,null,m]:[m?p:Xt(y),y,m]},[]),f=h.useCallback((p,m=!0,y)=>{const[x,N,v]=g(p);return x?(y||t.getState().getNodes()).filter(T=>{if(!v&&(T.id===N.id||!T.positionAbsolute))return!1;const I=Xt(T),L=wt(I,x);return m&&L>0||L>=x.width*x.height}):[]},[]),E=h.useCallback((p,m,y=!0)=>{const[x]=g(p);if(!x)return!1;const N=wt(x,m);return y&&N>0||N>=x.width*x.height},[]);return h.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:i,setNodes:r,setEdges:c,addNodes:l,addEdges:u,toObject:a,deleteElements:d,getIntersectingNodes:f,isNodeIntersecting:E}),[e,n,o,s,i,r,c,l,u,a,d,f,E])}const Ys={actInsideInputWithModifier:!1};var Zs=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ne(),{deleteElements:o}=Wn(),s=et(e,Ys),i=et(t);h.useEffect(()=>{if(s){const{edges:r,getNodes:c}=n.getState(),l=c().filter(a=>a.selected),u=r.filter(a=>a.selected);o({nodes:l,edges:u}),n.setState({nodesSelectionActive:!1})}},[s]),h.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function Us(e){const t=ne();h.useEffect(()=>{let n;const o=()=>{if(!e.current)return;const s=It(e.current);(s.height===0||s.width===0)&&t.getState().onError?.("004",ye.error004()),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const Bt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ws=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,rt=e=>({x:e.x,y:e.y,zoom:e.k}),Le=(e,t)=>e.target.closest(`.${t}`),on=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),sn=e=>{const t=e.ctrlKey&&it()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Xs=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Gs=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:r=!1,panOnScrollSpeed:c=.5,panOnScrollMode:l=De.Free,zoomOnDoubleClick:u=!0,elementsSelectable:a,panOnDrag:d=!0,defaultViewport:g,translateExtent:f,minZoom:E,maxZoom:p,zoomActivationKeyCode:m,preventScrolling:y=!0,children:x,noWheelClassName:N,noPanClassName:v})=>{const T=h.useRef(),I=ne(),L=h.useRef(!1),P=h.useRef(!1),C=h.useRef(null),$=h.useRef({x:0,y:0,zoom:0}),{d3Zoom:D,d3Selection:R,d3ZoomHandler:M,userSelectionActive:S}=q(Xs,se),A=et(m),B=h.useRef(0),Y=h.useRef(!1),F=h.useRef();return Us(C),h.useEffect(()=>{if(C.current){const w=C.current.getBoundingClientRect(),_=Uo().scaleExtent([E,p]).translateExtent(f),k=mn(C.current).call(_),H=Ye.translate(g.x,g.y).scale(We(g.zoom,E,p)),V=[[0,0],[w.width,w.height]],Z=_.constrain()(H,V,f);_.transform(k,Z),_.wheelDelta(sn),I.setState({d3Zoom:_,d3Selection:k,d3ZoomHandler:k.on("wheel.zoom"),transform:[Z.x,Z.y,Z.k],domNode:C.current.closest(".react-flow")})}},[]),h.useEffect(()=>{R&&D&&(r&&!A&&!S?R.on("wheel.zoom",w=>{if(Le(w,N))return!1;w.preventDefault(),w.stopImmediatePropagation();const _=R.property("__zoom").k||1;if(w.ctrlKey&&i){const te=Wo(w),J=sn(w),X=_*Math.pow(2,J);D.scaleTo(R,X,te,w);return}const k=w.deltaMode===1?20:1;let H=l===De.Vertical?0:w.deltaX*k,V=l===De.Horizontal?0:w.deltaY*k;!it()&&w.shiftKey&&l!==De.Vertical&&(H=w.deltaY*k,V=0),D.translateBy(R,-(H/_)*c,-(V/_)*c,{internal:!0});const Z=rt(R.property("__zoom")),{onViewportChangeStart:W,onViewportChange:j,onViewportChangeEnd:ee}=I.getState();clearTimeout(F.current),Y.current||(Y.current=!0,t?.(w,Z),W?.(Z)),Y.current&&(e?.(w,Z),j?.(Z),F.current=setTimeout(()=>{n?.(w,Z),ee?.(Z),Y.current=!1},150))},{passive:!1}):typeof M<"u"&&R.on("wheel.zoom",function(w,_){if(!y&&w.type==="wheel"&&!w.ctrlKey||Le(w,N))return null;w.preventDefault(),M.call(this,w,_)},{passive:!1}))},[S,r,l,R,D,M,A,i,y,N,t,e,n]),h.useEffect(()=>{D&&D.on("start",w=>{if(!w.sourceEvent||w.sourceEvent.internal)return null;B.current=w.sourceEvent?.button;const{onViewportChangeStart:_}=I.getState(),k=rt(w.transform);L.current=!0,$.current=k,w.sourceEvent?.type==="mousedown"&&I.setState({paneDragging:!0}),_?.(k),t?.(w.sourceEvent,k)})},[D,t]),h.useEffect(()=>{D&&(S&&!L.current?D.on("zoom",null):S||D.on("zoom",w=>{const{onViewportChange:_}=I.getState();if(I.setState({transform:[w.transform.x,w.transform.y,w.transform.k]}),P.current=!!(o&&on(d,B.current??0)),(e||_)&&!w.sourceEvent?.internal){const k=rt(w.transform);_?.(k),e?.(w.sourceEvent,k)}}))},[S,D,e,d,o]),h.useEffect(()=>{D&&D.on("end",w=>{if(!w.sourceEvent||w.sourceEvent.internal)return null;const{onViewportChangeEnd:_}=I.getState();if(L.current=!1,I.setState({paneDragging:!1}),o&&on(d,B.current??0)&&!P.current&&o(w.sourceEvent),P.current=!1,(n||_)&&Ws($.current,w.transform)){const k=rt(w.transform);$.current=k,clearTimeout(T.current),T.current=setTimeout(()=>{_?.(k),n?.(w.sourceEvent,k)},r?150:0)}})},[D,r,d,n,o]),h.useEffect(()=>{D&&D.filter(w=>{const _=A||s,k=i&&w.ctrlKey;if((d===!0||Array.isArray(d)&&d.includes(1))&&w.button===1&&w.type==="mousedown"&&(Le(w,"react-flow__node")||Le(w,"react-flow__edge")))return!0;if(!d&&!_&&!r&&!u&&!i||S||!u&&w.type==="dblclick"||Le(w,N)&&w.type==="wheel"||Le(w,v)&&(w.type!=="wheel"||r&&w.type==="wheel"&&!A)||!i&&w.ctrlKey&&w.type==="wheel"||!_&&!r&&!k&&w.type==="wheel"||!d&&(w.type==="mousedown"||w.type==="touchstart")||Array.isArray(d)&&!d.includes(w.button)&&w.type==="mousedown")return!1;const H=Array.isArray(d)&&d.includes(w.button)||!w.button||w.button<=1;return(!w.ctrlKey||w.type==="wheel")&&H})},[S,D,s,i,r,u,d,a,A]),b.createElement("div",{className:"react-flow__renderer",ref:C,style:Bt},x)},Ks=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function qs(){const{userSelectionActive:e,userSelectionRect:t}=q(Ks,se);return e&&t?b.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function rn(e,t){const n=t.parentNode||t.parentId,o=e.find(s=>s.id===n);if(o){const s=t.position.x+t.width-o.width,i=t.position.y+t.height-o.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),i>0&&(o.style.height+=i),t.position.x<0){const r=Math.abs(t.position.x);o.position.x=o.position.x-r,o.style.width+=r,t.position.x=0}if(t.position.y<0){const r=Math.abs(t.position.y);o.position.y=o.position.y-r,o.style.height+=r,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function Xn(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const i=e.filter(c=>c.id===s.id);if(i.length===0)return o.push(s),o;const r={...s};for(const c of i)if(c)switch(c.type){case"select":{r.selected=c.selected;break}case"position":{typeof c.position<"u"&&(r.position=c.position),typeof c.positionAbsolute<"u"&&(r.positionAbsolute=c.positionAbsolute),typeof c.dragging<"u"&&(r.dragging=c.dragging),r.expandParent&&rn(o,r);break}case"dimensions":{typeof c.dimensions<"u"&&(r.width=c.dimensions.width,r.height=c.dimensions.height),typeof c.updateStyle<"u"&&(r.style={...r.style||{},...c.dimensions}),typeof c.resizing=="boolean"&&(r.resizing=c.resizing),r.expandParent&&rn(o,r);break}case"remove":return o}return o.push(r),o},n)}function Gn(e,t){return Xn(e,t)}function js(e,t){return Xn(e,t)}const Ee=(e,t)=>({id:e,type:"select",selected:t});function Fe(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push(Ee(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push(Ee(o.id,!1))),n},[])}const xt=(e,t)=>n=>{n.target===t.current&&e?.(n)},Qs=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Kn=h.memo(({isSelecting:e,selectionMode:t=Je.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:r,onPaneScroll:c,onPaneMouseEnter:l,onPaneMouseMove:u,onPaneMouseLeave:a,children:d})=>{const g=h.useRef(null),f=ne(),E=h.useRef(0),p=h.useRef(0),m=h.useRef(),{userSelectionActive:y,elementsSelectable:x,dragging:N}=q(Qs,se),v=()=>{f.setState({userSelectionActive:!1,userSelectionRect:null}),E.current=0,p.current=0},T=M=>{i?.(M),f.getState().resetSelectedElements(),f.setState({nodesSelectionActive:!1})},I=M=>{if(Array.isArray(n)&&n?.includes(2)){M.preventDefault();return}r?.(M)},L=c?M=>c(M):void 0,P=M=>{const{resetSelectedElements:S,domNode:A}=f.getState();if(m.current=A?.getBoundingClientRect(),!x||!e||M.button!==0||M.target!==g.current||!m.current)return;const{x:B,y:Y}=we(M,m.current);S(),f.setState({userSelectionRect:{width:0,height:0,startX:B,startY:Y,x:B,y:Y}}),o?.(M)},C=M=>{const{userSelectionRect:S,nodeInternals:A,edges:B,transform:Y,onNodesChange:F,onEdgesChange:w,nodeOrigin:_,getNodes:k}=f.getState();if(!e||!m.current||!S)return;f.setState({userSelectionActive:!0,nodesSelectionActive:!1});const H=we(M,m.current),V=S.startX??0,Z=S.startY??0,W={...S,x:H.x<V?H.x:V,y:H.y<Z?H.y:Z,width:Math.abs(H.x-V),height:Math.abs(H.y-Z)},j=k(),ee=$n(A,W,Y,t===Je.Partial,!0,_),te=In(ee,B).map(X=>X.id),J=ee.map(X=>X.id);if(E.current!==J.length){E.current=J.length;const X=Fe(j,J);X.length&&F?.(X)}if(p.current!==te.length){p.current=te.length;const X=Fe(B,te);X.length&&w?.(X)}f.setState({userSelectionRect:W})},$=M=>{if(M.button!==0)return;const{userSelectionRect:S}=f.getState();!y&&S&&M.target===g.current&&T?.(M),f.setState({nodesSelectionActive:E.current>0}),v(),s?.(M)},D=M=>{y&&(f.setState({nodesSelectionActive:E.current>0}),s?.(M)),v()},R=x&&(e||y);return b.createElement("div",{className:ie(["react-flow__pane",{dragging:N,selection:e}]),onClick:R?void 0:xt(T,g),onContextMenu:xt(I,g),onWheel:xt(L,g),onMouseEnter:R?void 0:l,onMouseDown:R?P:void 0,onMouseMove:R?C:u,onMouseUp:R?$:void 0,onMouseLeave:R?D:a,ref:g,style:Bt},d,b.createElement(qs,null))});Kn.displayName="Pane";function qn(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const o=t.get(n);return o?o.selected?!0:qn(o,t):!1}function cn(e,t,n){let o=e;do{if(o?.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function Js(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!qn(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>({id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(s.positionAbsolute?.x??0),y:n.y-(s.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}))}function er(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function jn(e,t,n,o,s=[0,0],i){const r=er(e,e.extent||o);let c=r;const l=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(l&&e.width&&e.height){const d=n.get(l),{x:g,y:f}=Ze(d,s).positionAbsolute;c=d&&le(g)&&le(f)&&le(d.width)&&le(d.height)?[[g+e.width*s[0],f+e.height*s[1]],[g+d.width-e.width+e.width*s[0],f+d.height-e.height+e.height*s[1]]]:c}else i?.("005",ye.error005()),c=r;else if(e.extent&&l&&e.extent!=="parent"){const d=n.get(l),{x:g,y:f}=Ze(d,s).positionAbsolute;c=[[e.extent[0][0]+g,e.extent[0][1]+f],[e.extent[1][0]+g,e.extent[1][1]+f]]}let u={x:0,y:0};if(l){const d=n.get(l);u=Ze(d,s).positionAbsolute}const a=c&&c!=="parent"?Dt(t,c):t;return{position:{x:a.x-u.x,y:a.y-u.y},positionAbsolute:a}}function Et({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const an=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),r=t.getBoundingClientRect(),c={x:r.width*o[0],y:r.height*o[1]};return i.map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(u.left-r.left-c.x)/n,y:(u.top-r.top-c.y)/n,...It(l)}})};function je(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function At({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:r,nodeInternals:c,onError:l}=t.getState(),u=c.get(e);if(!u){l?.("012",ye.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&r)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):s([e])}function tr(){const e=ne();return h.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:i}=e.getState(),r=n.touches?n.touches[0].clientX:n.clientX,c=n.touches?n.touches[0].clientY:n.clientY,l={x:(r-o[0])/o[2],y:(c-o[1])/o[2]};return{xSnapped:i?s[0]*Math.round(l.x/s[0]):l.x,ySnapped:i?s[1]*Math.round(l.y/s[1]):l.y,...l}},[])}function St(e){return(t,n,o)=>e?.(t,o)}function Qn({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:i,selectNodesOnDrag:r}){const c=ne(),[l,u]=h.useState(!1),a=h.useRef([]),d=h.useRef({x:null,y:null}),g=h.useRef(0),f=h.useRef(null),E=h.useRef({x:0,y:0}),p=h.useRef(null),m=h.useRef(!1),y=h.useRef(!1),x=h.useRef(!1),N=tr();return h.useEffect(()=>{if(e?.current){const v=mn(e.current),T=({x:P,y:C})=>{const{nodeInternals:$,onNodeDrag:D,onSelectionDrag:R,updateNodePositions:M,nodeExtent:S,snapGrid:A,snapToGrid:B,nodeOrigin:Y,onError:F}=c.getState();d.current={x:P,y:C};let w=!1,_={x:0,y:0,x2:0,y2:0};if(a.current.length>1&&S){const H=_t(a.current,Y);_=Rt(H)}if(a.current=a.current.map(H=>{const V={x:P-H.distance.x,y:C-H.distance.y};B&&(V.x=A[0]*Math.round(V.x/A[0]),V.y=A[1]*Math.round(V.y/A[1]));const Z=[[S[0][0],S[0][1]],[S[1][0],S[1][1]]];a.current.length>1&&S&&!H.extent&&(Z[0][0]=H.positionAbsolute.x-_.x+S[0][0],Z[1][0]=H.positionAbsolute.x+(H.width??0)-_.x2+S[1][0],Z[0][1]=H.positionAbsolute.y-_.y+S[0][1],Z[1][1]=H.positionAbsolute.y+(H.height??0)-_.y2+S[1][1]);const W=jn(H,V,$,Z,Y,F);return w=w||H.position.x!==W.position.x||H.position.y!==W.position.y,H.position=W.position,H.positionAbsolute=W.positionAbsolute,H}),!w)return;M(a.current,!0,!0),u(!0);const k=s?D:St(R);if(k&&p.current){const[H,V]=Et({nodeId:s,dragItems:a.current,nodeInternals:$});k(p.current,H,V)}},I=()=>{if(!f.current)return;const[P,C]=En(E.current,f.current);if(P!==0||C!==0){const{transform:$,panBy:D}=c.getState();d.current.x=(d.current.x??0)-P/$[2],d.current.y=(d.current.y??0)-C/$[2],D({x:P,y:C})&&T(d.current)}g.current=requestAnimationFrame(I)},L=P=>{const{nodeInternals:C,multiSelectionActive:$,nodesDraggable:D,unselectNodesAndEdges:R,onNodeDragStart:M,onSelectionDragStart:S}=c.getState();y.current=!0;const A=s?M:St(S);(!r||!i)&&!$&&s&&(C.get(s)?.selected||R()),s&&i&&r&&At({id:s,store:c,nodeRef:e});const B=N(P);if(d.current=B,a.current=Js(C,D,B,s),A&&a.current){const[Y,F]=Et({nodeId:s,dragItems:a.current,nodeInternals:C});A(P.sourceEvent,Y,F)}};if(t)v.on(".drag",null);else{const P=Xo().on("start",C=>{const{domNode:$,nodeDragThreshold:D}=c.getState();D===0&&L(C),x.current=!1;const R=N(C);d.current=R,f.current=$?.getBoundingClientRect()||null,E.current=we(C.sourceEvent,f.current)}).on("drag",C=>{const $=N(C),{autoPanOnNodeDrag:D,nodeDragThreshold:R}=c.getState();if(C.sourceEvent.type==="touchmove"&&C.sourceEvent.touches.length>1&&(x.current=!0),!x.current){if(!m.current&&y.current&&D&&(m.current=!0,I()),!y.current){const M=$.xSnapped-(d?.current?.x??0),S=$.ySnapped-(d?.current?.y??0);Math.sqrt(M*M+S*S)>R&&L(C)}(d.current.x!==$.xSnapped||d.current.y!==$.ySnapped)&&a.current&&y.current&&(p.current=C.sourceEvent,E.current=we(C.sourceEvent,f.current),T($))}}).on("end",C=>{if(!(!y.current||x.current)&&(u(!1),m.current=!1,y.current=!1,cancelAnimationFrame(g.current),a.current)){const{updateNodePositions:$,nodeInternals:D,onNodeDragStop:R,onSelectionDragStop:M}=c.getState(),S=s?R:St(M);if($(a.current,!1,!1),S){const[A,B]=Et({nodeId:s,dragItems:a.current,nodeInternals:D});S(C.sourceEvent,A,B)}}}).filter(C=>{const $=C.target;return!C.button&&(!n||!cn($,`.${n}`,e))&&(!o||cn($,o,e))});return v.call(P),()=>{v.on(".drag",null)}}}},[e,t,n,o,i,c,s,r,N]),l}function Jn(){const e=ne();return h.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:i,getNodes:r,snapToGrid:c,snapGrid:l,onError:u,nodesDraggable:a}=e.getState(),d=r().filter(x=>x.selected&&(x.draggable||a&&typeof x.draggable>"u")),g=c?l[0]:5,f=c?l[1]:5,E=n.isShiftPressed?4:1,p=n.x*g*E,m=n.y*f*E,y=d.map(x=>{if(x.positionAbsolute){const N={x:x.positionAbsolute.x+p,y:x.positionAbsolute.y+m};c&&(N.x=l[0]*Math.round(N.x/l[0]),N.y=l[1]*Math.round(N.y/l[1]));const{positionAbsolute:v,position:T}=jn(x,N,o,s,void 0,u);x.position=T,x.positionAbsolute=v}return x});i(y,!0,!1)},[])}const Ue={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Qe=e=>{const t=({id:n,type:o,data:s,xPos:i,yPos:r,xPosOrigin:c,yPosOrigin:l,selected:u,onClick:a,onMouseEnter:d,onMouseMove:g,onMouseLeave:f,onContextMenu:E,onDoubleClick:p,style:m,className:y,isDraggable:x,isSelectable:N,isConnectable:v,isFocusable:T,selectNodesOnDrag:I,sourcePosition:L,targetPosition:P,hidden:C,resizeObserver:$,dragHandle:D,zIndex:R,isParent:M,noDragClassName:S,noPanClassName:A,initialized:B,disableKeyboardA11y:Y,ariaLabel:F,rfId:w,hasHandleBounds:_})=>{const k=ne(),H=h.useRef(null),V=h.useRef(null),Z=h.useRef(L),W=h.useRef(P),j=h.useRef(o),ee=N||x||a||d||g||f,te=Jn(),J=je(n,k.getState,d),X=je(n,k.getState,g),de=je(n,k.getState,f),ce=je(n,k.getState,E),ue=je(n,k.getState,p),ae=G=>{const{nodeDragThreshold:O}=k.getState();if(N&&(!I||!x||O>0)&&At({id:n,store:k,nodeRef:H}),a){const re=k.getState().nodeInternals.get(n);re&&a(G,{...re})}},Q=G=>{if(!bt(G)&&!Y)if(wn.includes(G.key)&&N){const O=G.key==="Escape";At({id:n,store:k,unselect:O,nodeRef:H})}else x&&u&&Object.prototype.hasOwnProperty.call(Ue,G.key)&&(k.setState({ariaLiveMessage:`Moved selected node ${G.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~r}`}),te({x:Ue[G.key].x,y:Ue[G.key].y,isShiftPressed:G.shiftKey}))};h.useEffect(()=>()=>{V.current&&($?.unobserve(V.current),V.current=null)},[]),h.useEffect(()=>{if(H.current&&!C){const G=H.current;(!B||!_||V.current!==G)&&(V.current&&$?.unobserve(V.current),$?.observe(G),V.current=G)}},[C,B,_]),h.useEffect(()=>{const G=j.current!==o,O=Z.current!==L,re=W.current!==P;H.current&&(G||O||re)&&(G&&(j.current=o),O&&(Z.current=L),re&&(W.current=P),k.getState().updateNodeDimensions([{id:n,nodeElement:H.current,forceUpdate:!0}]))},[n,o,L,P]);const ge=Qn({nodeRef:H,disabled:C||!x,noDragClassName:S,handleSelector:D,nodeId:n,isSelectable:N,selectNodesOnDrag:I});return C?null:b.createElement("div",{className:ie(["react-flow__node",`react-flow__node-${o}`,{[A]:x},y,{selected:u,selectable:N,parent:M,dragging:ge}]),ref:H,style:{zIndex:R,transform:`translate(${c}px,${l}px)`,pointerEvents:ee?"all":"none",visibility:B?"visible":"hidden",...m},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:J,onMouseMove:X,onMouseLeave:de,onContextMenu:ce,onClick:ae,onDoubleClick:ue,onKeyDown:T?Q:void 0,tabIndex:T?0:void 0,role:T?"button":void 0,"aria-describedby":Y?void 0:`${Vn}-${w}`,"aria-label":F},b.createElement(hs,{value:n},b.createElement(e,{id:n,data:s,type:o,xPos:i,yPos:r,selected:u,isConnectable:v,sourcePosition:L,targetPosition:P,dragging:ge,dragHandle:D,zIndex:R})))};return t.displayName="NodeWrapper",h.memo(t)};const nr=e=>{const t=e.getNodes().filter(n=>n.selected);return{..._t(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function or({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ne(),{width:s,height:i,x:r,y:c,transformString:l,userSelectionActive:u}=q(nr,se),a=Jn(),d=h.useRef(null);if(h.useEffect(()=>{n||d.current?.focus({preventScroll:!0})},[n]),Qn({nodeRef:d}),u||!s||!i)return null;const g=e?E=>{const p=o.getState().getNodes().filter(m=>m.selected);e(E,p)}:void 0,f=E=>{Object.prototype.hasOwnProperty.call(Ue,E.key)&&a({x:Ue[E.key].x,y:Ue[E.key].y,isShiftPressed:E.shiftKey})};return b.createElement("div",{className:ie(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l}},b.createElement("div",{ref:d,className:"react-flow__nodesselection-rect",onContextMenu:g,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:s,height:i,top:c,left:r}}))}var sr=h.memo(or);const rr=e=>e.nodesSelectionActive,eo=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,deleteKeyCode:c,onMove:l,onMoveStart:u,onMoveEnd:a,selectionKeyCode:d,selectionOnDrag:g,selectionMode:f,onSelectionStart:E,onSelectionEnd:p,multiSelectionKeyCode:m,panActivationKeyCode:y,zoomActivationKeyCode:x,elementsSelectable:N,zoomOnScroll:v,zoomOnPinch:T,panOnScroll:I,panOnScrollSpeed:L,panOnScrollMode:P,zoomOnDoubleClick:C,panOnDrag:$,defaultViewport:D,translateExtent:R,minZoom:M,maxZoom:S,preventScrolling:A,onSelectionContextMenu:B,noWheelClassName:Y,noPanClassName:F,disableKeyboardA11y:w})=>{const _=q(rr),k=et(d),H=et(y),V=H||$,Z=H||I,W=k||g&&V!==!0;return Zs({deleteKeyCode:c,multiSelectionKeyCode:m}),b.createElement(Gs,{onMove:l,onMoveStart:u,onMoveEnd:a,onPaneContextMenu:i,elementsSelectable:N,zoomOnScroll:v,zoomOnPinch:T,panOnScroll:Z,panOnScrollSpeed:L,panOnScrollMode:P,zoomOnDoubleClick:C,panOnDrag:!k&&V,defaultViewport:D,translateExtent:R,minZoom:M,maxZoom:S,zoomActivationKeyCode:x,preventScrolling:A,noWheelClassName:Y,noPanClassName:F},b.createElement(Kn,{onSelectionStart:E,onSelectionEnd:p,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,panOnDrag:V,isSelecting:!!W,selectionMode:f},e,_&&b.createElement(sr,{onSelectionContextMenu:B,noPanClassName:F,disableKeyboardA11y:w})))};eo.displayName="FlowRenderer";var ir=h.memo(eo);function cr(e){return q(h.useCallback(n=>e?$n(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function ar(e){const t={input:Qe(e.input||zn),default:Qe(e.default||Mt),output:Qe(e.output||Bn),group:Qe(e.group||Ot)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=Qe(e[i]||Mt),s),n);return{...t,...o}}const lr=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},dr=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),to=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:i,onError:r}=q(dr,se),c=cr(e.onlyRenderVisibleElements),l=h.useRef(),u=h.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const a=new ResizeObserver(d=>{const g=d.map(f=>({id:f.target.getAttribute("data-id"),nodeElement:f.target,forceUpdate:!0}));i(g)});return l.current=a,a},[]);return h.useEffect(()=>()=>{l?.current?.disconnect()},[]),b.createElement("div",{className:"react-flow__nodes",style:Bt},c.map(a=>{let d=a.type||"default";e.nodeTypes[d]||(r?.("003",ye.error003(d)),d="default");const g=e.nodeTypes[d]||e.nodeTypes.default,f=!!(a.draggable||t&&typeof a.draggable>"u"),E=!!(a.selectable||s&&typeof a.selectable>"u"),p=!!(a.connectable||n&&typeof a.connectable>"u"),m=!!(a.focusable||o&&typeof a.focusable>"u"),y=e.nodeExtent?Dt(a.positionAbsolute,e.nodeExtent):a.positionAbsolute,x=y?.x??0,N=y?.y??0,v=lr({x,y:N,width:a.width??0,height:a.height??0,origin:e.nodeOrigin});return b.createElement(g,{key:a.id,id:a.id,className:a.className,style:a.style,type:d,data:a.data,sourcePosition:a.sourcePosition||z.Bottom,targetPosition:a.targetPosition||z.Top,hidden:a.hidden,xPos:x,yPos:N,xPosOrigin:v.x,yPosOrigin:v.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!a.selected,isDraggable:f,isSelectable:E,isConnectable:p,isFocusable:m,resizeObserver:u,dragHandle:a.dragHandle,zIndex:a[K]?.z??0,isParent:!!a[K]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!a.width&&!!a.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:a.ariaLabel,hasHandleBounds:!!a[K]?.handleBounds})}))};to.displayName="NodeRenderer";var ur=h.memo(to);const fr=(e,t,n)=>n===z.Left?e-t:n===z.Right?e+t:e,gr=(e,t,n)=>n===z.Top?e-t:n===z.Bottom?e+t:e,ln="react-flow__edgeupdater",dn=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:i,onMouseOut:r,type:c})=>b.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:r,className:ie([ln,`${ln}-${c}`]),cx:fr(t,o,e),cy:gr(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),pr=()=>!0;var Ve=e=>{const t=({id:n,className:o,type:s,data:i,onClick:r,onEdgeDoubleClick:c,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:g,labelBgStyle:f,labelBgPadding:E,labelBgBorderRadius:p,style:m,source:y,target:x,sourceX:N,sourceY:v,targetX:T,targetY:I,sourcePosition:L,targetPosition:P,elementsSelectable:C,hidden:$,sourceHandleId:D,targetHandleId:R,onContextMenu:M,onMouseEnter:S,onMouseMove:A,onMouseLeave:B,reconnectRadius:Y,onReconnect:F,onReconnectStart:w,onReconnectEnd:_,markerEnd:k,markerStart:H,rfId:V,ariaLabel:Z,isFocusable:W,isReconnectable:j,pathOptions:ee,interactionWidth:te,disableKeyboardA11y:J})=>{const X=h.useRef(null),[de,ce]=h.useState(!1),[ue,ae]=h.useState(!1),Q=ne(),ge=h.useMemo(()=>`url('#${Ct(H,V)}')`,[H,V]),G=h.useMemo(()=>`url('#${Ct(k,V)}')`,[k,V]);if($)return null;const O=oe=>{const{edges:pe,addSelectedEdges:ve,unselectNodesAndEdges:Me,multiSelectionActive:ze}=Q.getState(),he=pe.find(Ae=>Ae.id===n);he&&(C&&(Q.setState({nodesSelectionActive:!1}),he.selected&&ze?(Me({nodes:[],edges:[he]}),X.current?.blur()):ve([n])),r&&r(oe,he))},re=qe(n,Q.getState,c),be=qe(n,Q.getState,M),Xe=qe(n,Q.getState,S),Te=qe(n,Q.getState,A),ke=qe(n,Q.getState,B),me=(oe,pe)=>{if(oe.button!==0)return;const{edges:ve,isValidConnection:Me}=Q.getState(),ze=pe?x:y,he=(pe?R:D)||null,Ae=pe?"target":"source",ft=Me||pr,gt=pe,Ke=ve.find($e=>$e.id===n);ae(!0),w?.(oe,Ke,Ae);const pt=$e=>{ae(!1),_?.($e,Ke,Ae)};kn({event:oe,handleId:he,nodeId:ze,onConnect:$e=>F?.(Ke,$e),isTarget:gt,getState:Q.getState,setState:Q.setState,isValidConnection:ft,edgeUpdaterType:Ae,onReconnectEnd:pt})},He=oe=>me(oe,!0),Ne=oe=>me(oe,!1),Ce=()=>ce(!0),Pe=()=>ce(!1),_e=!C&&!r,Ge=oe=>{if(!J&&wn.includes(oe.key)&&C){const{unselectNodesAndEdges:pe,addSelectedEdges:ve,edges:Me}=Q.getState();oe.key==="Escape"?(X.current?.blur(),pe({edges:[Me.find(he=>he.id===n)]})):ve([n])}};return b.createElement("g",{className:ie(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:l,animated:u,inactive:_e,updating:de}]),onClick:O,onDoubleClick:re,onContextMenu:be,onMouseEnter:Xe,onMouseMove:Te,onMouseLeave:ke,onKeyDown:W?Ge:void 0,tabIndex:W?0:void 0,role:W?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":Z===null?void 0:Z||`Edge from ${y} to ${x}`,"aria-describedby":W?`${Fn}-${V}`:void 0,ref:X},!ue&&b.createElement(e,{id:n,source:y,target:x,selected:l,animated:u,label:a,labelStyle:d,labelShowBg:g,labelBgStyle:f,labelBgPadding:E,labelBgBorderRadius:p,data:i,style:m,sourceX:N,sourceY:v,targetX:T,targetY:I,sourcePosition:L,targetPosition:P,sourceHandleId:D,targetHandleId:R,markerStart:ge,markerEnd:G,pathOptions:ee,interactionWidth:te}),j&&b.createElement(b.Fragment,null,(j==="source"||j===!0)&&b.createElement(dn,{position:L,centerX:N,centerY:v,radius:Y,onMouseDown:He,onMouseEnter:Ce,onMouseOut:Pe,type:"source"}),(j==="target"||j===!0)&&b.createElement(dn,{position:P,centerX:T,centerY:I,radius:Y,onMouseDown:Ne,onMouseEnter:Ce,onMouseOut:Pe,type:"target"})))};return t.displayName="EdgeWrapper",h.memo(t)};function hr(e){const t={default:Ve(e.default||at),straight:Ve(e.bezier||Ht),step:Ve(e.step||kt),smoothstep:Ve(e.step||ut),simplebezier:Ve(e.simplebezier||Tt)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=Ve(e[i]||at),s),n);return{...t,...o}}function un(e,t,n=null){const o=(n?.x||0)+t.x,s=(n?.y||0)+t.y,i=n?.width||t.width,r=n?.height||t.height;switch(e){case z.Top:return{x:o+i/2,y:s};case z.Right:return{x:o+i,y:s+r/2};case z.Bottom:return{x:o+i/2,y:s+r};case z.Left:return{x:o,y:s+r/2}}}function fn(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const mr=(e,t,n,o,s,i)=>{const r=un(n,e,t),c=un(i,o,s);return{sourceX:r.x,sourceY:r.y,targetX:c.x,targetY:c.y}};function yr({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:i,width:r,height:c,transform:l}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const a=Rt({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:r/l[2],height:c/l[2]}),d=Math.max(0,Math.min(a.x2,u.x2)-Math.max(a.x,u.x)),g=Math.max(0,Math.min(a.y2,u.y2)-Math.max(a.y,u.y));return Math.ceil(d*g)>0}function gn(e){const t=e?.[K]?.handleBounds||null,n=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const xr=[{level:0,isMaxLevel:!0,edges:[]}];function Er(e,t,n=!1){let o=-1;const s=e.reduce((r,c)=>{const l=le(c.zIndex);let u=l?c.zIndex:0;if(n){const a=t.get(c.target),d=t.get(c.source),g=c.selected||a?.selected||d?.selected,f=Math.max(d?.[K]?.z||0,a?.[K]?.z||0,1e3);u=(l?c.zIndex:0)+(g?f:0)}return r[u]?r[u].push(c):r[u]=[c],o=u>o?u:o,r},{}),i=Object.entries(s).map(([r,c])=>{const l=+r;return{edges:c,level:l,isMaxLevel:l===o}});return i.length===0?xr:i}function Sr(e,t,n){const o=q(h.useCallback(s=>e?s.edges.filter(i=>{const r=t.get(i.source),c=t.get(i.target);return r?.width&&r?.height&&c?.width&&c?.height&&yr({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:c.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:c.width,targetHeight:c.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return Er(o,t,n)}const wr=({color:e="none",strokeWidth:t=1})=>b.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),br=({color:e="none",strokeWidth:t=1})=>b.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),pn={[ct.Arrow]:wr,[ct.ArrowClosed]:br};function Nr(e){const t=ne();return h.useMemo(()=>Object.prototype.hasOwnProperty.call(pn,e)?pn[e]:(t.getState().onError?.("009",ye.error009(e)),null),[e])}const Cr=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:r,orient:c="auto-start-reverse"})=>{const l=Nr(t);return l?b.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:c,refX:"0",refY:"0"},b.createElement(l,{color:n,strokeWidth:r})):null},vr=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(r=>{if(r&&typeof r=="object"){const c=Ct(r,t);o.includes(c)||(s.push({id:c,color:r.color||e,...r}),o.push(c))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},no=({defaultColor:e,rfId:t})=>{const n=q(h.useCallback(vr({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((i,r)=>i.id!==s[r].id)));return b.createElement("defs",null,n.map(o=>b.createElement(Cr,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};no.displayName="MarkerDefinitions";var Mr=h.memo(no);const Ar=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),oo=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:r,onEdgeMouseEnter:c,onEdgeMouseMove:l,onEdgeMouseLeave:u,onEdgeClick:a,onEdgeDoubleClick:d,onReconnect:g,onReconnectStart:f,onReconnectEnd:E,reconnectRadius:p,children:m,disableKeyboardA11y:y})=>{const{edgesFocusable:x,edgesUpdatable:N,elementsSelectable:v,width:T,height:I,connectionMode:L,nodeInternals:P,onError:C}=q(Ar,se),$=Sr(t,P,n);return T?b.createElement(b.Fragment,null,$.map(({level:D,edges:R,isMaxLevel:M})=>b.createElement("svg",{key:D,style:{zIndex:D},width:T,height:I,className:"react-flow__edges react-flow__container"},M&&b.createElement(Mr,{defaultColor:e,rfId:o}),b.createElement("g",null,R.map(S=>{const[A,B,Y]=gn(P.get(S.source)),[F,w,_]=gn(P.get(S.target));if(!Y||!_)return null;let k=S.type||"default";s[k]||(C?.("011",ye.error011(k)),k="default");const H=s[k]||s.default,V=L===Re.Strict?w.target:(w.target??[]).concat(w.source??[]),Z=fn(B.source,S.sourceHandle),W=fn(V,S.targetHandle),j=Z?.position||z.Bottom,ee=W?.position||z.Top,te=!!(S.focusable||x&&typeof S.focusable>"u"),J=S.reconnectable||S.updatable,X=typeof g<"u"&&(J||N&&typeof J>"u");if(!Z||!W)return C?.("008",ye.error008(Z,S)),null;const{sourceX:de,sourceY:ce,targetX:ue,targetY:ae}=mr(A,Z,j,F,W,ee);return b.createElement(H,{key:S.id,id:S.id,className:ie([S.className,i]),type:k,data:S.data,selected:!!S.selected,animated:!!S.animated,hidden:!!S.hidden,label:S.label,labelStyle:S.labelStyle,labelShowBg:S.labelShowBg,labelBgStyle:S.labelBgStyle,labelBgPadding:S.labelBgPadding,labelBgBorderRadius:S.labelBgBorderRadius,style:S.style,source:S.source,target:S.target,sourceHandleId:S.sourceHandle,targetHandleId:S.targetHandle,markerEnd:S.markerEnd,markerStart:S.markerStart,sourceX:de,sourceY:ce,targetX:ue,targetY:ae,sourcePosition:j,targetPosition:ee,elementsSelectable:v,onContextMenu:r,onMouseEnter:c,onMouseMove:l,onMouseLeave:u,onClick:a,onEdgeDoubleClick:d,onReconnect:g,onReconnectStart:f,onReconnectEnd:E,reconnectRadius:p,rfId:o,ariaLabel:S.ariaLabel,isFocusable:te,isReconnectable:X,pathOptions:"pathOptions"in S?S.pathOptions:void 0,interactionWidth:S.interactionWidth,disableKeyboardA11y:y})})))),m):null};oo.displayName="EdgeRenderer";var $r=h.memo(oo);const Ir=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Dr({children:e}){const t=q(Ir);return b.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function Rr(e){const t=Wn(),n=h.useRef(!1);h.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Tr={[z.Left]:z.Right,[z.Right]:z.Left,[z.Top]:z.Bottom,[z.Bottom]:z.Top},so=({nodeId:e,handleType:t,style:n,type:o=Se.Bezier,CustomComponent:s,connectionStatus:i})=>{const{fromNode:r,handleId:c,toX:l,toY:u,connectionMode:a}=q(h.useCallback(I=>({fromNode:I.nodeInternals.get(e),handleId:I.connectionHandleId,toX:(I.connectionPosition.x-I.transform[0])/I.transform[2],toY:(I.connectionPosition.y-I.transform[1])/I.transform[2],connectionMode:I.connectionMode}),[e]),se),d=r?.[K]?.handleBounds;let g=d?.[t];if(a===Re.Loose&&(g=g||d?.[t==="source"?"target":"source"]),!r||!g)return null;const f=c?g.find(I=>I.id===c):g[0],E=f?f.x+f.width/2:(r.width??0)/2,p=f?f.y+f.height/2:r.height??0,m=(r.positionAbsolute?.x??0)+E,y=(r.positionAbsolute?.y??0)+p,x=f?.position,N=x?Tr[x]:null;if(!x||!N)return null;if(s)return b.createElement(s,{connectionLineType:o,connectionLineStyle:n,fromNode:r,fromHandle:f,fromX:m,fromY:y,toX:l,toY:u,fromPosition:x,toPosition:N,connectionStatus:i});let v="";const T={sourceX:m,sourceY:y,sourcePosition:x,targetX:l,targetY:u,targetPosition:N};return o===Se.Bezier?[v]=Mn(T):o===Se.Step?[v]=Nt({...T,borderRadius:0}):o===Se.SmoothStep?[v]=Nt(T):o===Se.SimpleBezier?[v]=vn(T):v=`M${m},${y} ${l},${u}`,b.createElement("path",{d:v,fill:"none",className:"react-flow__connection-path",style:n})};so.displayName="ConnectionLine";const kr=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function Hr({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:i,nodesConnectable:r,width:c,height:l,connectionStatus:u}=q(kr,se);return!(s&&i&&c&&r)?null:b.createElement("svg",{style:e,width:c,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},b.createElement("g",{className:ie(["react-flow__connection",u])},b.createElement(so,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:o,connectionStatus:u})))}function hn(e,t){return h.useRef(null),ne(),h.useMemo(()=>t(e),[e])}const ro=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:i,onNodeClick:r,onEdgeClick:c,onNodeDoubleClick:l,onEdgeDoubleClick:u,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:g,onNodeContextMenu:f,onSelectionContextMenu:E,onSelectionStart:p,onSelectionEnd:m,connectionLineType:y,connectionLineStyle:x,connectionLineComponent:N,connectionLineContainerStyle:v,selectionKeyCode:T,selectionOnDrag:I,selectionMode:L,multiSelectionKeyCode:P,panActivationKeyCode:C,zoomActivationKeyCode:$,deleteKeyCode:D,onlyRenderVisibleElements:R,elementsSelectable:M,selectNodesOnDrag:S,defaultViewport:A,translateExtent:B,minZoom:Y,maxZoom:F,preventScrolling:w,defaultMarkerColor:_,zoomOnScroll:k,zoomOnPinch:H,panOnScroll:V,panOnScrollSpeed:Z,panOnScrollMode:W,zoomOnDoubleClick:j,panOnDrag:ee,onPaneClick:te,onPaneMouseEnter:J,onPaneMouseMove:X,onPaneMouseLeave:de,onPaneScroll:ce,onPaneContextMenu:ue,onEdgeContextMenu:ae,onEdgeMouseEnter:Q,onEdgeMouseMove:ge,onEdgeMouseLeave:G,onReconnect:O,onReconnectStart:re,onReconnectEnd:be,reconnectRadius:Xe,noDragClassName:Te,noWheelClassName:ke,noPanClassName:me,elevateEdgesOnSelect:He,disableKeyboardA11y:Ne,nodeOrigin:Ce,nodeExtent:Pe,rfId:_e})=>{const Ge=hn(e,ar),oe=hn(t,hr);return Rr(i),b.createElement(ir,{onPaneClick:te,onPaneMouseEnter:J,onPaneMouseMove:X,onPaneMouseLeave:de,onPaneContextMenu:ue,onPaneScroll:ce,deleteKeyCode:D,selectionKeyCode:T,selectionOnDrag:I,selectionMode:L,onSelectionStart:p,onSelectionEnd:m,multiSelectionKeyCode:P,panActivationKeyCode:C,zoomActivationKeyCode:$,elementsSelectable:M,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:k,zoomOnPinch:H,zoomOnDoubleClick:j,panOnScroll:V,panOnScrollSpeed:Z,panOnScrollMode:W,panOnDrag:ee,defaultViewport:A,translateExtent:B,minZoom:Y,maxZoom:F,onSelectionContextMenu:E,preventScrolling:w,noDragClassName:Te,noWheelClassName:ke,noPanClassName:me,disableKeyboardA11y:Ne},b.createElement(Dr,null,b.createElement($r,{edgeTypes:oe,onEdgeClick:c,onEdgeDoubleClick:u,onlyRenderVisibleElements:R,onEdgeContextMenu:ae,onEdgeMouseEnter:Q,onEdgeMouseMove:ge,onEdgeMouseLeave:G,onReconnect:O,onReconnectStart:re,onReconnectEnd:be,reconnectRadius:Xe,defaultMarkerColor:_,noPanClassName:me,elevateEdgesOnSelect:!!He,disableKeyboardA11y:Ne,rfId:_e},b.createElement(Hr,{style:x,type:y,component:N,containerStyle:v})),b.createElement("div",{className:"react-flow__edgelabel-renderer"}),b.createElement(ur,{nodeTypes:Ge,onNodeClick:r,onNodeDoubleClick:l,onNodeMouseEnter:a,onNodeMouseMove:d,onNodeMouseLeave:g,onNodeContextMenu:f,selectNodesOnDrag:S,onlyRenderVisibleElements:R,noPanClassName:me,noDragClassName:Te,disableKeyboardA11y:Ne,nodeOrigin:Ce,nodeExtent:Pe,rfId:_e})))};ro.displayName="GraphView";var Pr=h.memo(ro);const $t=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],xe={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:$t,nodeExtent:$t,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Re.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:ls,isValidConnection:void 0},_r=()=>Jo((e,t)=>({...xe,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:yt(n,o,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",i=typeof o<"u",r=s?yt(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:r,edges:i?o:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:r,fitViewOnInitOptions:c,domNode:l,nodeOrigin:u}=t(),a=l?.querySelector(".react-flow__viewport");if(!a)return;const d=window.getComputedStyle(a),{m22:g}=new window.DOMMatrixReadOnly(d.transform),f=n.reduce((p,m)=>{const y=s.get(m.id);if(y?.hidden)s.set(y.id,{...y,[K]:{...y[K],handleBounds:void 0}});else if(y){const x=It(m.nodeElement);x.width&&x.height&&(y.width!==x.width||y.height!==x.height||m.forceUpdate)&&(s.set(y.id,{...y,[K]:{...y[K],handleBounds:{source:an(".source",m.nodeElement,g,u),target:an(".target",m.nodeElement,g,u)}},...x}),p.push({id:y.id,type:"dimensions",dimensions:x}))}return p},[]);Zn(s,u);const E=r||i&&!r&&Un(t,{initial:!0,...c});e({nodeInternals:new Map(s),fitViewOnInitDone:E}),f?.length>0&&o?.(f)},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),r=n.map(c=>{const l={id:c.id,type:"position",dragging:s};return o&&(l.positionAbsolute=c.positionAbsolute,l.position=c.position),l});i(r)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:r,getNodes:c,elevateNodesOnSelect:l}=t();if(n?.length){if(i){const u=Gn(n,c()),a=yt(u,s,r,l);e({nodeInternals:a})}o?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>Ee(l,!0)):(r=Fe(i(),n),c=Fe(s,[])),st({changedNodes:r,changedEdges:c,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>Ee(l,!0)):(r=Fe(s,n),c=Fe(i(),[])),st({changedNodes:c,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:i}=t(),r=n||i(),c=o||s,l=r.map(a=>(a.selected=!1,Ee(a.id,!1))),u=c.map(a=>Ee(a.id,!1));st({changedNodes:l,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o?.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o?.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),i=o().filter(c=>c.selected).map(c=>Ee(c.id,!1)),r=n.filter(c=>c.selected).map(c=>Ee(c.id,!1));st({changedNodes:i,changedEdges:r,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=Dt(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:i,d3Zoom:r,d3Selection:c,translateExtent:l}=t();if(!r||!c||!n.x&&!n.y)return!1;const u=Ye.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),a=[[0,0],[s,i]],d=r?.constrain()(u,a,l);return r.transform(c,d),o[0]!==d.x||o[1]!==d.y||o[2]!==d.k},cancelConnection:()=>e({connectionNodeId:xe.connectionNodeId,connectionHandleId:xe.connectionHandleId,connectionHandleType:xe.connectionHandleType,connectionStatus:xe.connectionStatus,connectionStartHandle:xe.connectionStartHandle,connectionEndHandle:xe.connectionEndHandle}),reset:()=>e({...xe})}),Object.is),io=({children:e})=>{const t=h.useRef(null);return t.current||(t.current=_r()),b.createElement(es,{value:t.current},e)};io.displayName="ReactFlowProvider";const co=({children:e})=>h.useContext(dt)?b.createElement(b.Fragment,null,e):b.createElement(io,null,e);co.displayName="ReactFlowWrapper";const zr={input:zn,default:Mt,output:Bn,group:Ot},Or={default:at,straight:Ht,step:kt,smoothstep:ut,simplebezier:Tt},Br=[0,0],Lr=[15,15],Vr={x:0,y:0,zoom:1},Fr={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Yr=h.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:i=zr,edgeTypes:r=Or,onNodeClick:c,onEdgeClick:l,onInit:u,onMove:a,onMoveStart:d,onMoveEnd:g,onConnect:f,onConnectStart:E,onConnectEnd:p,onClickConnectStart:m,onClickConnectEnd:y,onNodeMouseEnter:x,onNodeMouseMove:N,onNodeMouseLeave:v,onNodeContextMenu:T,onNodeDoubleClick:I,onNodeDragStart:L,onNodeDrag:P,onNodeDragStop:C,onNodesDelete:$,onEdgesDelete:D,onSelectionChange:R,onSelectionDragStart:M,onSelectionDrag:S,onSelectionDragStop:A,onSelectionContextMenu:B,onSelectionStart:Y,onSelectionEnd:F,connectionMode:w=Re.Strict,connectionLineType:_=Se.Bezier,connectionLineStyle:k,connectionLineComponent:H,connectionLineContainerStyle:V,deleteKeyCode:Z="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:j=!1,selectionMode:ee=Je.Full,panActivationKeyCode:te="Space",multiSelectionKeyCode:J=it()?"Meta":"Control",zoomActivationKeyCode:X=it()?"Meta":"Control",snapToGrid:de=!1,snapGrid:ce=Lr,onlyRenderVisibleElements:ue=!1,selectNodesOnDrag:ae=!0,nodesDraggable:Q,nodesConnectable:ge,nodesFocusable:G,nodeOrigin:O=Br,edgesFocusable:re,edgesUpdatable:be,elementsSelectable:Xe,defaultViewport:Te=Vr,minZoom:ke=.5,maxZoom:me=2,translateExtent:He=$t,preventScrolling:Ne=!0,nodeExtent:Ce,defaultMarkerColor:Pe="#b1b1b7",zoomOnScroll:_e=!0,zoomOnPinch:Ge=!0,panOnScroll:oe=!1,panOnScrollSpeed:pe=.5,panOnScrollMode:ve=De.Free,zoomOnDoubleClick:Me=!0,panOnDrag:ze=!0,onPaneClick:he,onPaneMouseEnter:Ae,onPaneMouseMove:ft,onPaneMouseLeave:gt,onPaneScroll:Ke,onPaneContextMenu:pt,children:Lt,onEdgeContextMenu:$e,onEdgeDoubleClick:uo,onEdgeMouseEnter:fo,onEdgeMouseMove:go,onEdgeMouseLeave:po,onEdgeUpdate:ho,onEdgeUpdateStart:mo,onEdgeUpdateEnd:yo,onReconnect:xo,onReconnectStart:Eo,onReconnectEnd:So,reconnectRadius:wo=10,edgeUpdaterRadius:bo=10,onNodesChange:No,onEdgesChange:Co,noDragClassName:vo="nodrag",noWheelClassName:Mo="nowheel",noPanClassName:Vt="nopan",fitView:Ao=!1,fitViewOptions:$o,connectOnClick:Io=!0,attributionPosition:Do,proOptions:Ro,defaultEdgeOptions:To,elevateNodesOnSelect:ko=!0,elevateEdgesOnSelect:Ho=!1,disableKeyboardA11y:Ft=!1,autoPanOnConnect:Po=!0,autoPanOnNodeDrag:_o=!0,connectionRadius:zo=20,isValidConnection:Oo,onError:Bo,style:Lo,id:Yt,nodeDragThreshold:Vo,...Fo},Yo)=>{const ht=Yt||"1";return b.createElement("div",{...Fo,style:{...Lo,...Fr},ref:Yo,className:ie(["react-flow",s]),"data-testid":"rf__wrapper",id:Yt},b.createElement(co,null,b.createElement(Pr,{onInit:u,onMove:a,onMoveStart:d,onMoveEnd:g,onNodeClick:c,onEdgeClick:l,onNodeMouseEnter:x,onNodeMouseMove:N,onNodeMouseLeave:v,onNodeContextMenu:T,onNodeDoubleClick:I,nodeTypes:i,edgeTypes:r,connectionLineType:_,connectionLineStyle:k,connectionLineComponent:H,connectionLineContainerStyle:V,selectionKeyCode:W,selectionOnDrag:j,selectionMode:ee,deleteKeyCode:Z,multiSelectionKeyCode:J,panActivationKeyCode:te,zoomActivationKeyCode:X,onlyRenderVisibleElements:ue,selectNodesOnDrag:ae,defaultViewport:Te,translateExtent:He,minZoom:ke,maxZoom:me,preventScrolling:Ne,zoomOnScroll:_e,zoomOnPinch:Ge,zoomOnDoubleClick:Me,panOnScroll:oe,panOnScrollSpeed:pe,panOnScrollMode:ve,panOnDrag:ze,onPaneClick:he,onPaneMouseEnter:Ae,onPaneMouseMove:ft,onPaneMouseLeave:gt,onPaneScroll:Ke,onPaneContextMenu:pt,onSelectionContextMenu:B,onSelectionStart:Y,onSelectionEnd:F,onEdgeContextMenu:$e,onEdgeDoubleClick:uo,onEdgeMouseEnter:fo,onEdgeMouseMove:go,onEdgeMouseLeave:po,onReconnect:xo??ho,onReconnectStart:Eo??mo,onReconnectEnd:So??yo,reconnectRadius:wo??bo,defaultMarkerColor:Pe,noDragClassName:vo,noWheelClassName:Mo,noPanClassName:Vt,elevateEdgesOnSelect:Ho,rfId:ht,disableKeyboardA11y:Ft,nodeOrigin:O,nodeExtent:Ce}),b.createElement(Ts,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:f,onConnectStart:E,onConnectEnd:p,onClickConnectStart:m,onClickConnectEnd:y,nodesDraggable:Q,nodesConnectable:ge,nodesFocusable:G,edgesFocusable:re,edgesUpdatable:be,elementsSelectable:Xe,elevateNodesOnSelect:ko,minZoom:ke,maxZoom:me,nodeExtent:Ce,onNodesChange:No,onEdgesChange:Co,snapToGrid:de,snapGrid:ce,connectionMode:w,translateExtent:He,connectOnClick:Io,defaultEdgeOptions:To,fitView:Ao,fitViewOptions:$o,onNodesDelete:$,onEdgesDelete:D,onNodeDragStart:L,onNodeDrag:P,onNodeDragStop:C,onSelectionDrag:S,onSelectionDragStart:M,onSelectionDragStop:A,noPanClassName:Vt,nodeOrigin:O,rfId:ht,autoPanOnConnect:Po,autoPanOnNodeDrag:_o,onError:Bo,connectionRadius:zo,isValidConnection:Oo,nodeDragThreshold:Vo}),b.createElement(Ds,{onSelectionChange:R}),Lt,b.createElement(os,{proOptions:Ro,position:Do}),b.createElement(zs,{rfId:ht,disableKeyboardA11y:Ft})))});Yr.displayName="ReactFlow";function ao(e){return t=>{const[n,o]=h.useState(t),s=h.useCallback(i=>o(r=>e(i,r)),[]);return[n,o,s]}}const Qr=ao(Gn),Jr=ao(js);var fe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(fe||(fe={}));function Zr({color:e,dimensions:t,lineWidth:n}){return b.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Ur({color:e,radius:t}){return b.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Wr={[fe.Dots]:"#91919a",[fe.Lines]:"#eee",[fe.Cross]:"#e2e2e2"},Xr={[fe.Dots]:1,[fe.Lines]:1,[fe.Cross]:6},Gr=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function lo({id:e,variant:t=fe.Dots,gap:n=20,size:o,lineWidth:s=1,offset:i=2,color:r,style:c,className:l}){const u=h.useRef(null),{transform:a,patternId:d}=q(Gr,se),g=r||Wr[t],f=o||Xr[t],E=t===fe.Dots,p=t===fe.Cross,m=Array.isArray(n)?n:[n,n],y=[m[0]*a[2]||1,m[1]*a[2]||1],x=f*a[2],N=p?[x,x]:y,v=E?[x/i,x/i]:[N[0]/i,N[1]/i];return b.createElement("svg",{className:ie(["react-flow__background",l]),style:{...c,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},b.createElement("pattern",{id:d+e,x:a[0]%y[0],y:a[1]%y[1],width:y[0],height:y[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${v[0]},-${v[1]})`},E?b.createElement(Ur,{color:g,radius:x/i}):b.createElement(Zr,{dimensions:N,color:g,lineWidth:s})),b.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${d+e})`}))}lo.displayName="Background";var ei=h.memo(lo);export{ei as B,lt as H,ct as M,z as P,Yr as R,Jr as a,ne as b,q as c,Wn as d,ns as e,ie as f,se as s,Qr as u};
